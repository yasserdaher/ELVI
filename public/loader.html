<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>ELVI DELUXE LOADER</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Three.js + GSAP -->
<script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/gsap@3.14.1/dist/gsap.min.js"></script>

<style>
body{margin:0;overflow:hidden;font-family:Tahoma,Arial;background:#01010a;color:#fff}
canvas{display:block;position:fixed;top:0;left:0;z-index:1}

/* Overlay UI */
#overlay{
  position:fixed;inset:0;z-index:10;display:flex;flex-direction:column;
  align-items:center;justify-content:center;pointer-events:none
}
.loader-title{
  font-size:36px;color:#7ee0ff;letter-spacing:2px;margin-bottom:20px;
  text-shadow:0 0 15px #7ee0ff,0 0 30px #a0fff0
}
.progress-container{
  width:400px;height:22px;background:rgba(255,255,255,0.05);
  border-radius:20px;overflow:hidden;margin-top:20px
}
.progress-bar{
  height:100%;width:0%;background:linear-gradient(90deg,#7ee0ff,#a0fff0);
  border-radius:20px;transition:width .4s ease
}
.status{
  margin-top:20px;font-size:16px;opacity:.85;text-align:center;
  text-shadow:0 0 10px #7ee0ff
}
</style>
</head>
<body>

<canvas id="c"></canvas>

<div id="overlay">
  <div class="loader-title">ELVI DELUXE SYSTEM</div>
  <div class="progress-container"><div class="progress-bar" id="bar"></div></div>
  <div class="status" id="status">تهيئة النظام…</div>
</div>

<script>
// ===== Three.js Scene =====
const canvas=document.getElementById("c");
const scene=new THREE.Scene();
const camera=new THREE.PerspectiveCamera(60,window.innerWidth/window.innerHeight,0.1,1000);
camera.position.z=50;

const renderer=new THREE.WebGLRenderer({canvas:canvas,antialias:true,alpha:true});
renderer.setSize(window.innerWidth,window.innerHeight);

window.addEventListener('resize',()=>{
  camera.aspect=window.innerWidth/window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth,window.innerHeight);
});

// ===== Particles =====
const particleCount=1500;
const geometry=new THREE.BufferGeometry();
const positions=new Float32Array(particleCount*3);
for(let i=0;i<particleCount;i++){
  positions[i*3]=(Math.random()-0.5)*250;
  positions[i*3+1]=(Math.random()-0.5)*250;
  positions[i*3+2]=(Math.random()-0.5)*250;
}
geometry.setAttribute('position',new THREE.BufferAttribute(positions,3));

const material=new THREE.PointsMaterial({color:0x7ee0ff,size:1.8,transparent:true,opacity:0.8});
const points=new THREE.Points(geometry,material);
scene.add(points);

// ===== Soft Lights =====
const light1=new THREE.PointLight(0x7ee0ff,0.8,500);
light1.position.set(50,50,50);
scene.add(light1);
const light2=new THREE.PointLight(0xa0fff0,0.5,500);
light2.position.set(-50,-50,50);
scene.add(light2);

// ===== Animation =====
function animate(){
  requestAnimationFrame(animate);
  points.rotation.y+=0.0015;
  points.rotation.x+=0.001;
  renderer.render(scene,camera);
}
animate();

// ===== Mouse Parallax =====
document.addEventListener('mousemove',(e)=>{
  const mx=(e.clientX-window.innerWidth/2)/window.innerWidth*20;
  const my=(e.clientY-window.innerHeight/2)/window.innerHeight*20;
  gsap.to(camera.position,{duration:0.5,x:mx,y:-my});
  camera.lookAt(scene.position);
});

// ===== Dynamic Status Messages =====
const messages=["تهيئة النظام…","تحميل الموارد…","مزامنة البيانات…","تحسين الأداء…","التحقق من السلامة…"];
let i=0;
setInterval(()=>{document.getElementById("status").textContent=messages[i++%messages.length]},1300);

// ===== Progress & Page Check =====
const bar=document.getElementById("bar");
const assets=["index.html"];
let loaded=0;
function updateBar(){bar.style.width=Math.round((loaded/assets.length)*100)+"%";}
const check = setInterval(async () => {
  try {
    const res = await fetch("/index.html", { method: "HEAD", cache: "no-store" });
    if (res.ok) {
      loaded = 1;
      updateBar();
      clearInterval(check);
      gsap.to(document.body, { duration: 1.5, opacity: 0, onComplete: () => window.location.href = "/index.html" });
    }
  } catch (e) {
    console.error("Loader fetch failed:", e);
  }
}, 500);

</script>

</body>
</html>
